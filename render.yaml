services:
  - type: web
    name: ibm-fullstack-developer-capstone
    root: server
    runtime: python:3.12
    buildCommand: |
      pip install -r requirements.txt
      cd frontend && npm install && npm run build && cd ..
      python manage.py migrate --noinput
      python manage.py collectstatic --noinput
    startCommand: gunicorn djangoproj.wsgi:application --bind 0.0.0.0:8000
    envVars:
      - key: SECRET_KEY
        scope: build
      - key: DEBUG
        value: "False"
      - key: DATABASE_URL
        scope: build
